#!/bin/bash

show_help() {
    echo "Использование: $0 [опции]"
    echo "Опции:"
    echo "  --tofile <файл>  Сохранить информацию в указанный файл"
    echo "  -h               Показать справку"
    exit 0
}

display_menu() {
    echo "Выберите информацию для отображения:"
    echo "1) Текущий рабочий каталог"
    echo "2) Текущий запущенный процесс"
    echo "3) Домашний каталог"
    echo "4) Название и версия ОС"
    echo "5) Все доступные оболочки"
    echo "6) Текущие пользователи в системе"
    echo "7) Количество вошедших пользователей"
    echo "8) Информация о жестких дисках"
    echo "9) Информация о процессоре"
    echo "10) Информация о памяти"
    echo "11) Информация о файловой системе"
    echo "12) Информация об установленных пакетах ПО"
    echo "13) Вывести всю информацию"
    echo "14) Выход"
}

collect_info() {
    echo "========================================"
    echo "Текущий рабочий каталог: $(pwd)"
    echo "========================================"
    echo "Текущий запущенный процесс: $$"
    echo "========================================"
    echo "Домашний каталог: $HOME"
    echo "========================================"
    echo "Название и версия ОС: $(uname -a)"
    echo "========================================"
    echo "Доступные оболочки:"
    cat /etc/shells
    echo "========================================"
    echo "Текущие пользователи:"
    who
    echo "========================================"
    echo "Количество вошедших пользователей: $(who | wc -l)"
    echo "========================================"
    echo "Информация о жестких дисках:"
    df -h
    echo "========================================"
    echo "Информация о процессоре:"
    lscpu
    echo "========================================"
    echo "Информация о памяти:"
    free -h
    echo "========================================"
    echo "Информация о файловой системе:"
    mount | column -t
    echo "========================================"
    echo "Информация об установленных пакетах ПО:"
    dpkg -l 2>/dev/null 
    echo "========================================"
}

if [[ $1 == "--tofile" && -n $2 ]]; then
    collect_info > "$2"
    echo "Информация сохранена в файл $2"
    exit 0
fi

if [[ $1 == "-h" ]]; then
    show_help
fi

while true; do
    display_menu
    read -p "Введите номер пункта: " choice
    case $choice in
        1) echo "Текущий рабочий каталог: $(pwd)" ;;
        2) echo "Текущий запущенный процесс: $$" ;;
        3) echo "Домашний каталог: $HOME" ;;
        4) echo "Название и версия ОС: $(uname -a)" ;;
        5) echo "Доступные оболочки:"; cat /etc/shells ;;
        6) echo "Текущие пользователи:"; who ;;
        7) echo "Количество вошедших пользователей: $(who | wc -l)" ;;
        8) echo "Информация о жестких дисках:"; df -h ;;
        9) echo "Информация о процессоре:"; lscpu ;;
        10) echo "Информация о памяти:"; free -h ;;
        11) echo "Информация о файловой системе:"; mount | column -t ;;
        12) echo "Информация об установленных пакетах ПО:"; dpkg -l 2>/dev/null ;;
        13) collect_info ;;
        14) echo "Выход..."; exit 0 ;;
        *) echo "Некорректный ввод, попробуйте снова." ;;
    esac
    echo "Для продолжения нажмите Enter..."
    read
done
